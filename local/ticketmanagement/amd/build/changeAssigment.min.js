define("local_ticketmanagement/changeAssigment",["exports","core_form/modalform","core/notification","core/toast","core/str"],(function(_exports,_modalform,_notification,_toast,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_notification=_interopRequireDefault(_notification);_exports.init=()=>{document.querySelectorAll("tr.cerrado .assignbtn").forEach((link=>{link.addEventListener("click",(event=>{window.console.log("changeAssigment"),event.stopPropagation(),event.preventDefault()})),link.style.cursor="not-allowed"}));document.querySelectorAll("tr:not(.cerrado) .assignbtn").forEach((node=>{node.addEventListener("click",(e=>{e.target.closest("tr").classList.contains("cerrado")?(e.stopPropagation(),e.preventDefault()):showAssigmentFormPopup(e)}))}))};const showAssigmentFormPopup=e=>{e.stopPropagation();const ticketId=e.target.closest("tr").querySelector(".tickets").textContent,modalForm=new _modalform.default({formClass:"\\local_ticketmanagement\\form\\AssignmentFormPopup",args:{num_ticket:ticketId},modalConfig:{title:"Ticket details: #".concat(ticketId)},returnFocus:e.target});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(e=>{const ticket=e.detail.ticket;window.console.log("done");const tr=document.querySelector('td a.assignbtn[data-ticketid="'.concat(ticket.id,'"]')).closest("tr");tr.classList.remove("yellow");document.querySelector('td a.assignbtn[data-ticketid="'.concat(ticket.id,'"]')).parentElement;document.querySelector('a.assignbtn[data-ticketid="'.concat(ticket.id,'"]')).nextElementSibling.textContent=ticket.user;tr.querySelector("td:nth-child(6)").textContent=ticket.state})),modalForm.addEventListener(modalForm.events.LOADED,(e=>{})),modalForm.show()}}));

//# sourceMappingURL=changeAssigment.min.js.map