{"version":3,"file":"addTicket.min.js","sources":["../src/addTicket.js"],"sourcesContent":["import ModalForm from 'core_form/modalform';\nimport Notification from 'core/notification';\nimport {add as addToast} from 'core/toast';\nimport {get_string as getString} from 'core/str';\nimport {exception as displayException} from 'core/notification';\nimport Templates from 'core/templates';\n\n\nconst url=M.cfg.wwwroot+'/webservice/rest/server.php';\nconst token=document.querySelector('input[name=\"token\"]').value;\n\nexport const init =() => {\n    const bonewticket=document.querySelector(\"#id_bocreate\");\n    bonewticket.addEventListener('click',(e)=>{\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        const project=document.querySelector('#id_project').value;\n        const vessel=document.querySelector('#id_vessel').value;\n        const trainee=document.querySelector('#id_userlist').value;\n        const category=(document.querySelector('#id_category').value)?document.querySelector('#id_category').value:0;\n        const subcategory=(document.querySelector('#id_subcategory').value)?document.querySelector('#id_subcategory').value:0;\n        \n        \n        const familyissue=document.querySelector('#id_familyissue').value;\n        const description=document.querySelector('textarea[name=\"description[text]\"]').value;\n        const fileid=document.querySelector('#id_attachments').value;\n        let familiar=trainee;\n        if (familyissue==='yes'){\n          if (document.querySelector('#id_familiar').value!=='')\n            familiar=document.querySelector('#id_familiar').value;\n        }\n        const newTicket={\n            projectid:project,\n            vesselid:vessel,\n            traineeid:trainee,\n            categoryid:category,\n            subcategoryid:subcategory,\n            state:\"Open\",\n            priority:\"Medium\",\n            description:description,\n            fileid:fileid,\n            familiarid:familiar\n        };\n\n        if (category!==0 && subcategory!==0)\n          createNewTicket(newTicket);\n        else{\n          Notification.addNotification({message:'Error: No categories have been defined yet. No ticket has been inserted',type:'error'});\n        }\n\n    })\n}\n\nconst createNewTicket=(newTicket)=>{\n    let xhr = new XMLHttpRequest();\n    \n    //Se prepara el objeto a enviar\n    const formData= new FormData();\n    formData.append('wstoken',token);\n    formData.append('wsfunction', 'local_ticketmanagement_add_ticket');\n    formData.append('moodlewsrestformat', 'json');\n    formData.append('params[0][subcategoryid]',newTicket.subcategoryid);\n    formData.append('params[0][traineeid]',newTicket.traineeid);\n    formData.append('params[0][state]',newTicket.state);\n    formData.append('params[0][priority]',newTicket.priority);\n    formData.append('params[0][description]',newTicket.description);\n    formData.append('params[0][fileid]',newTicket.fileid);\n    formData.append('params[0][familiarid]',newTicket.familiarid);\n\n    xhr.open('POST',url,true);\n    xhr.send(formData);\n\n    xhr.onload = (ev)=> {\n        reqHandlerNewTicket(xhr);\n    }\n\n    xhr.onerror = ()=> {\n        rejectAnswer(xhr);\n    }\n}\n\nconst reqHandlerNewTicket = (xhr) => {\n  if (xhr.readyState === 4 && xhr.status === 200) {\n      if (xhr.response) {\n          const response = JSON.parse(xhr.response);\n\n          if (response) {\n              window.console.log(response);\n              addToast('Ticket created successfully: ' + response.id);\n\n              // Actualiza el número de tickets y las páginas\n              let numRecords = parseInt(document.querySelector('#num_records').textContent.trim()) + 1;\n              let numPages = Math.ceil(numRecords / 25); // Cálculo de las páginas necesarias\n              let currentPage = numPages;\n\n              // Actualiza la lista de páginas en el paginador\n              const pageList = [];\n              let pagePrevious = Math.max(1, currentPage - 1);\n              let pageNext = currentPage + 1;\n              if (numPages===1){\n                pageNext=1;\n              }\n              \n              \n              for (let i = 1; i <= numPages; i++) {\n                  pageList.push({\n                      page: i,\n                      active: i === currentPage\n                  });\n              }\n\n              const formattedResponse = {\n                  listadoTickets: [{\n                      ticketnumber: response.id,\n                      username: response.username,\n                      familyissue: response.familyissue,\n                      state: response.state,\n                      priority: response.priority,\n                      assigned: 'Waiting to be assigned.',\n                      date: response.dateticket,\n                      description: response.description,\n                      familyissue: response.familyissue\n                  }],\n                  num_records: numRecords,\n                  num_total_records: numRecords,\n                  num_pages: numPages,\n                  pages: pageList,\n                  previous: [{\n                      page: pagePrevious,\n                      url: '#'\n                  }],\n                  next: [{\n                      page: pageNext,\n                      url: '#'\n                  }],\n                  first: [{\n                      page: 1,\n                      url: '#'\n                  }],\n                  last: [{\n                      page: numPages,\n                      url: '#'\n                  }],\n              };\n\n              addTickettoTemplate(formattedResponse);\n          } else {\n              addToast('Something went wrong. No ticket created');\n          }\n      }\n  }\n};\n\n\nfunction addTickettoTemplate(response){\n    //Render the choosen mustache template by Javascript\n    Templates.renderForPromise('local_ticketmanagement/tr_log-ajax',response)\n    .then(({html,js})=>{\n      const content=document.querySelector('#tablebody');\n      const numRecords = document.querySelectorAll('.tickets').length;\n      \n      // Si el número total de registros supera los 25, limpiar la tabla para una nueva página\n      if (numRecords >= 25) {\n        content.innerHTML = '';  // Limpiar solo cuando se supere el límite de 25 registros\n      }\n\n      Templates.appendNodeContents(content,html,js);\n      const newTicket=document.querySelectorAll('.tickets')[document.querySelectorAll('.tickets').length-1];\n      newTicket.addEventListener('click',(e)=>{\n        showTicketFormPopup(e);\n      });\n\n      const logs=document.querySelectorAll('.logs')[document.querySelectorAll('.logs').length-1];\n\n    \n        logs.addEventListener('click',(e)=>{\n            showTicketActions(e);\n        })\n   \n\n      const assignbtn=document.querySelectorAll('.assignbtn')[document.querySelectorAll('.assignbtn').length-1];\n      assignbtn.addEventListener('click',(e)=>{\n        showAssigmentFormPopup(e);\n      })\n      \n      //En caso de que se superen 25 tickets por página, se crea una nueva página y añade el registro ahí\n\n\n      Templates.renderForPromise('local_ticketmanagement/pagebar_log-ajax',response)\n      .then(({html,js})=>{\n        const content=document.querySelector('#pagination');\n        content.innerHTML='';\n        Templates.appendNodeContents(content,html,js);\n\n\n        const pages=document.querySelectorAll('.page-link');\n        pages.forEach((page)=>{\n          page.addEventListener('click',(ev)=>{\n            window.console.log('adleante');\n            ev.preventDefault();\n            ev.stopPropagation();\n            const token = document.querySelector('input[name=\"token\"]');\n            const page= document.querySelector('input[name=\"page\"]');\n    \n            //Se obtiene el elemento padre del elemento clicado\n            const padre=ev.currentTarget.parentElement;\n            \n            if (padre.dataset.control==='first' || padre.dataset.control==='last' || padre.dataset.control==='previous' || padre.dataset.control==='next'){\n              //Si es la primera página se coge el valor de arial-label\n              page.value=ev.currentTarget.getAttribute('aria-label');\n            } else {\n              page.value=ev.currentTarget.textContent.trim();\n            }\n            \n            //Obtenemos el ordenamiento y el campo de orden actuales\n            const orderby = document.querySelector('input[name=\"orderby\"]').value;\n            const order = document.querySelector('input[name=\"order\"]').value;\n            const activePage=parseInt(page.value);\n            const startdate= document.querySelector('#startdate');\n            const enddate= document.querySelector('#enddate');\n    \n            const startdateUnixFormat=truncateDateToDay(new Date(startdate.value));\n            const enddateUnixFormat=truncateDateToDay(new Date(enddate.value));\n    \n            requestDataToServer(activePage,startdateUnixFormat, enddateUnixFormat,parseInt(order), orderby, parseInt(page.value), token.value, url);\n          });\n        });\n        \n      }).catch((error)=>displayException(error));\n    }).catch((error)=>displayException(error));\n  }\n\n  const truncateDateToDay=(date) =>{\n    // Create a new Date object with the year, month, and date from the input date.\n    const truncatedDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n  \n    // Convert the truncated date to Unix time (milliseconds since the Unix epoch).\n    const unixTime = truncatedDate.getTime() / 1000; // Divide by 1000 to get seconds\n  \n    return unixTime;\n  }\n\n  const requestDataToServer=(activePage,firstDayOfWeek, lastDayOfWeek, order,orderby,page,token,url)=>{\n    let xhr = new XMLHttpRequest();\n      \n      //Se prepara el objeto a enviar\n      const formData= new FormData();\n      formData.append('wstoken',token);\n      formData.append('wsfunction', 'local_ticketmanagement_get_tickets');\n      formData.append('moodlewsrestformat', 'json');\n      formData.append('params[0][order]',order);\n      formData.append('params[0][orderby]',orderby);\n      formData.append('params[0][page]',page);\n      formData.append('params[0][startdate]',firstDayOfWeek);\n      formData.append('params[0][enddate]',lastDayOfWeek);\n      formData.append('params[0][activePage]',activePage);\n      \n      \n  \n      xhr.open('POST',url,true);\n      xhr.send(formData);\n  \n      xhr.onload = (ev)=> {\n          reqHandlerGetTickets(xhr);\n      }\n  \n      xhr.onerror = ()=> {\n          rejectAnswer(xhr);\n      }\n  }\n\n  const reqHandlerGetTickets=(xhr)=>{\n    if (xhr.readyState=== 4 && xhr. status === 200){\n      if (xhr.response){\n          const response=JSON.parse(xhr.response);\n          loadTemplatefromResponse(response);\n          \n      }\n   }\n  }\n  \n  const loadTemplatefromResponse=(response)=>{\n    //Render the choosen mustache template by Javascript\n    Templates.renderForPromise('local_ticketmanagement/content_log-ajax',response)\n    .then(({html,js})=>{\n    const content=document.querySelector('#content');\n    content.innerHTML='';\n      Templates.appendNodeContents(content,html,js);\n      \n      //Ahora que se ha cargado la plantilla, se puede añadir el evento a los enlaces de ordenación\n      const orderlinks=document.querySelectorAll('.orderby');\n      orderlinks.forEach((link)=>{\n        link.addEventListener('click',(ev)=>{\n          ev.preventDefault();\n  \n          //Se obtienen los valores de los campos necesarios\n          const token = document.querySelector('input[name=\"token\"]').value;\n          const page= document.querySelector('input[name=\"page\"]');\n  \n          //Obtenemos el ordenamiento y el campo de orden actuales\n          const orderby = document.querySelector('input[name=\"orderby\"]');\n          const order = document.querySelector('input[name=\"order\"]');\n  \n          //Si el campo de ordenamiento es el mismo que el actual, se cambia el orden\n          if (ev.target.dataset.activo==='activo'){\n            if (order.value==='1'){\n              ev.target.dataset.order=0;\n              order.value=0;\n            } else {\n              ev.target.dataset.order=1;\n              order.value=1;\n            }\n          } else {\n            orderlinks.forEach((link)=>{\n              link.dataset.activo='';\n            });\n            ev.target.dataset.activo='activo';\n            orderby.value=ev.target.dataset.orderby;\n            ev.target.dataset.order=1;\n            order.value=1;\n          }\n  \n          const activePage=document.querySelector('li.page-item.active>a').textContent.trim();\n  \n          const startdate= document.querySelector('#startdate');\n          const enddate= document.querySelector('#enddate');\n  \n          const startdateUnixFormat=truncateDateToDay(new Date(startdate.value));\n          const enddateUnixFormat=truncateDateToDay(new Date(enddate.value));\n          \n          requestDataToServer(activePage,startdateUnixFormat, enddateUnixFormat, parseInt(order.value),orderby.value,page.value,token,url);\n        });\n      });\n  \n      const pages=document.querySelectorAll('.page-link');\n      pages.forEach((page)=>{\n        page.addEventListener('click',(ev)=>{\n          ev.preventDefault();\n          ev.stopPropagation();\n          const token = document.querySelector('input[name=\"token\"]');\n          const page= document.querySelector('input[name=\"page\"]');\n  \n          //Se obtiene el elemento padre del elemento clicado\n          const padre=ev.currentTarget.parentElement;\n          \n          if (padre.dataset.control==='first' || padre.dataset.control==='last' || padre.dataset.control==='previous' || padre.dataset.control==='next'){\n            //Si es la primera página se coge el valor de arial-label\n            page.value=ev.currentTarget.getAttribute('aria-label');\n          } else {\n            page.value=ev.currentTarget.textContent.trim();\n          }\n          \n          //Obtenemos el ordenamiento y el campo de orden actuales\n          const orderby = document.querySelector('input[name=\"orderby\"]').value;\n          const order = document.querySelector('input[name=\"order\"]').value;\n          const activePage=parseInt(page.value);\n          const startdate= document.querySelector('#startdate');\n          const enddate= document.querySelector('#enddate');\n  \n          const startdateUnixFormat=truncateDateToDay(new Date(startdate.value));\n          const enddateUnixFormat=truncateDateToDay(new Date(enddate.value));\n  \n          requestDataToServer(activePage,startdateUnixFormat, enddateUnixFormat,parseInt(order), orderby, parseInt(page.value), token.value, url);\n        });\n      });\n  \n    })\n    .catch((error)=>displayException(error));\n  }\n\n  const showTicketFormPopup=(e)=>{\n    e.stopPropagation();\n    const ticketId=e.target.textContent.trim();\n    \n    const modalForm=new ModalForm({\n        formClass: \"\\\\local_ticketmanagement\\\\form\\\\TicketFormPopup\",\n        args: {num_ticket: ticketId},\n        modalConfig: {title: `Ticket details: #${ticketId}`},\n        returnFocus:e.target\n    });\n\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e)=>{\n         //Se actualiza la pagina principal con los nuevos valores y se envia email de notificación\n         const formElement=e.target;\n         const subcategoryValue = formElement.querySelector('select[name=\"subcategory\"]')?.value;\n         window.console.log(e.detail);\n         if (subcategoryValue) {\n             e.detail.subcategory = subcategoryValue;\n         }\n \n \n         updateTicket(e.detail,token,url);\n    });\n\n    modalForm.addEventListener(modalForm.events.LOADED, (e)=>{\n        // Obtener el formulario modal después de que se ha cargado\n        const formElement = e.target;\n    \n        // Usa la función areElementsLoaded para esperar hasta que los selectores estén cargados en el DOM\n        areElementsLoaded('select[name=\"category\"], select[name=\"subcategory\"]', formElement).then((elements) => {\n\n            // Una vez que los selectores están disponibles, los seleccionamos\n            const categorySelect = formElement.querySelector('select[name=\"category\"]');\n            const subcategorySelect = formElement.querySelector('select[name=\"subcategory\"]');\n    \n            // Asegúrate de que ambos selectores existen\n            if (categorySelect && subcategorySelect) {\n                // Añadir un listener para cuando cambie la categoría seleccionada\n                categorySelect.addEventListener('change', (event) => {\n                    const selectedCategory = event.target.value;\n                    window.console.log(`Categoría seleccionada: ${selectedCategory}`);\n    \n                    // Lógica para actualizar las opciones del selector de subcategorías\n                    updateSubcategory(selectedCategory, subcategorySelect,token);\n                });\n            } else {\n                window.console.error('Los selectores de categoría y subcategoría no están disponibles.');\n            }\n            \n        }).catch((error) => {\n            window.console.error('Error al cargar los elementos select:', error);\n        });\n        \n        }\n    );\n    \n    modalForm.show();\n\n}\n\nconst showAssigmentFormPopup=(e)=>{\n  e.stopPropagation();\n  const fila=e.target.closest('tr');\n  const ticket=fila.querySelector('.tickets');\n  const ticketId=ticket.textContent;\n  const modalForm=new ModalForm({\n      formClass: \"\\\\local_ticketmanagement\\\\form\\\\AssignmentFormPopup\",\n      args: {num_ticket: ticketId},\n      modalConfig: {title: `Ticket details: #${ticketId}`},\n      returnFocus:e.target\n  });\n\n  modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e)=>{\n      //Se actualiza la pagina principal con los nuevos valores y se envia email de notificación\n        \n      const ticket=e.detail.ticket;\n      const td=document.querySelector(`td a.assignbtn[data-ticketid=\"${ticket.id}\"]`).parentElement;\n      const link=document.querySelector(`a.assignbtn[data-ticketid=\"${ticket.id}\"]`)\n      const span = link.nextElementSibling; \n      span.textContent=ticket.user;\n      const state=document.querySelector(`td a.assignbtn[data-ticketid=\"${ticket.id}\"]`).parentElement.parentElement.children[4];\n      state.textContent=ticket.state;\n  });\n\n  modalForm.addEventListener(modalForm.events.LOADED, (e)=>{\n      //Changing the text of the dynamic button\n      //e.target.querySelector(\"button[data-action='save']\").textContent=\"Send Email\"\n      \n      }\n  );\n  \n  modalForm.show();\n\n}\n\nconst showTicketActions=(e)=>{\n  e.stopPropagation();\n  const ticketId=e.target.dataset.ticketid;\n  const modalForm=new ModalForm({\n      formClass: \"\\\\local_ticketmanagement\\\\form\\\\ActionsFormPopup\",\n      args: {num_ticket: ticketId},\n      modalConfig: {title: `Ticket details: #${ticketId}`},\n      returnFocus:e.target\n  });\n\n  modalForm.show();\n\n\n  modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e)=>{\n      //Se actualiza la pagina principal con los nuevos valores y se envia email de notificación\n  });\n\n  // Listen for the modal LOADED event\n  modalForm.addEventListener(modalForm.events.LOADED, (e) => {\n      // Get the button after the modal is fully loaded\n      // Get the modal element after it is loaded\n      \n      areElementsLoaded('#boactionid').then((elements)=>{\n          const addActionBtn = (elements.length>0)?elements[0]:null;\n          \n          if (addActionBtn) {\n              // Add an event listener to the button\n              addActionBtn.addEventListener('click', function() {\n                  console.log('Add Action button clicked!');\n              });\n          }\n\n      })\n  });\n}\n\nconst updateTicket = (obj,token,url)=>{\n  let xhr = new XMLHttpRequest();\n    \n    //Se prepara el objeto a enviar\n    const formData= new FormData();\n    formData.append('wstoken',token);\n    formData.append('wsfunction', 'local_ticketmanagement_edit_ticket');\n    formData.append('moodlewsrestformat', 'json');\n    formData.append('params[0][ticketid]',obj.ticketid);\n    formData.append('params[0][fileid]',obj.attachments);\n    formData.append('params[0][cancelled]',obj.cancelled);\n    formData.append('params[0][state]',obj.hiddenstate);\n    formData.append('params[0][priority]',obj.priority);\n    formData.append('params[0][closed]',obj.close);\n    formData.append('params[0][category]',obj.subcategory);\n\n    xhr.open('POST',url,true);\n    xhr.send(formData);\n\n    xhr.onload = (ev)=> {\n        reqHandlerUpdateTicket(xhr);\n    }\n\n    xhr.onerror = ()=> {\n        rejectAnswer(xhr);\n    }\n\n}\n\nconst reqHandlerUpdateTicket=(xhr)=>{\n  if (xhr.readyState=== 4 && xhr. status === 200){\n      if (xhr.response){\n          const response=JSON.parse(xhr.response);\n          \n          if (response){\n            window.console.log(response.ticket);\n            const ticket=response.ticket;\n            updateTemplate(ticket);\n          }\n          \n      }\n    }\n}\n\nconst updateTemplate=(ticket)=>{\n  const fila = document.querySelector(`#${ticket.ticketid}`);\n  const state = fila.querySelector('td:nth-child(5)');\n  const priority = fila.querySelector('td:nth-child(7)');\n  state.textContent=ticket.state;\n  priority.textContent=ticket.priority;\n\n}\n\nconst areElementsLoaded = (selector, parentElement = document) => {\n  return new Promise((resolve) => {\n      const checkElements = () => {\n          const elements = parentElement.querySelectorAll(selector);\n          if (elements.length > 0 && Array.from(elements).every(elem => elem !== null)) {\n              resolve(elements);\n          } else {\n              requestAnimationFrame(checkElements);\n          }\n      };\n      checkElements();\n  });\n};"],"names":["url","M","cfg","wwwroot","token","document","querySelector","value","addEventListener","e","preventDefault","stopImmediatePropagation","project","vessel","trainee","category","subcategory","familyissue","description","fileid","familiar","createNewTicket","projectid","vesselid","traineeid","categoryid","subcategoryid","state","priority","familiarid","addNotification","message","type","newTicket","xhr","XMLHttpRequest","formData","FormData","append","open","send","onload","ev","reqHandlerNewTicket","onerror","rejectAnswer","readyState","status","response","JSON","parse","window","console","log","id","numRecords","parseInt","textContent","trim","numPages","Math","ceil","currentPage","pageList","pagePrevious","max","pageNext","i","push","page","active","renderForPromise","then","_ref","html","js","content","querySelectorAll","length","innerHTML","appendNodeContents","showTicketFormPopup","showTicketActions","showAssigmentFormPopup","_ref2","forEach","stopPropagation","padre","currentTarget","parentElement","dataset","control","getAttribute","orderby","order","activePage","startdate","enddate","startdateUnixFormat","truncateDateToDay","Date","enddateUnixFormat","requestDataToServer","catch","error","addTickettoTemplate","listadoTickets","ticketnumber","username","assigned","date","dateticket","num_records","num_total_records","num_pages","pages","previous","next","first","last","getFullYear","getMonth","getDate","getTime","firstDayOfWeek","lastDayOfWeek","reqHandlerGetTickets","loadTemplatefromResponse","_ref3","orderlinks","link","target","activo","ticketId","modalForm","ModalForm","formClass","args","num_ticket","modalConfig","title","returnFocus","events","FORM_SUBMITTED","subcategoryValue","_formElement$querySel","detail","updateTicket","LOADED","formElement","areElementsLoaded","elements","categorySelect","subcategorySelect","event","selectedCategory","updateSubcategory","show","closest","ticket","nextElementSibling","user","children","ticketid","addActionBtn","obj","attachments","cancelled","hiddenstate","close","reqHandlerUpdateTicket","updateTemplate","fila","selector","Promise","resolve","checkElements","Array","from","every","elem","requestAnimationFrame"],"mappings":"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"}