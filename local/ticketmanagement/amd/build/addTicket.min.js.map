{"version":3,"file":"addTicket.min.js","sources":["../src/addTicket.js"],"sourcesContent":["import ModalForm from 'core_form/modalform';\nimport Notification from 'core/notification';\nimport {add as addToast} from 'core/toast';\nimport {get_string as getString} from 'core/str';\nimport {exception as displayException} from 'core/notification';\nimport Templates from 'core/templates';\n\n\nconst url=M.cfg.wwwroot+'/webservice/rest/server.php';\nconst token=document.querySelector('input[name=\"token\"]').value;\n\nexport const init =() => {\n    const bonewticket=document.querySelector(\"#id_bocreate\");\n    bonewticket.addEventListener('click',(e)=>{\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        const project=document.querySelector('#id_project').value;\n        const vessel=document.querySelector('#id_vessel').value;\n        const trainee=document.querySelector('#id_userlist').value;\n        const category=(document.querySelector('#id_category').value)?document.querySelector('#id_category').value:0;\n        const subcategory=(document.querySelector('#id_subcategory').value)?document.querySelector('#id_subcategory').value:0;\n        \n        \n        const familyissue=document.querySelector('#id_familyissue').value;\n        const description=document.querySelector('textarea[name=\"description[text]\"]').value;\n        const fileid=document.querySelector('#id_attachments').value;\n        let familiar=trainee;\n        if (familyissue==='yes'){\n          if (document.querySelector('#id_familiar').value!=='')\n            familiar=document.querySelector('#id_familiar').value;\n        }\n        const newTicket={\n            projectid:project,\n            vesselid:vessel,\n            traineeid:trainee,\n            categoryid:category,\n            subcategoryid:subcategory,\n            state:\"Open\",\n            priority:\"Medium\",\n            description:description,\n            fileid:fileid,\n            familiarid:familiar\n        };\n\n        if (category!==0 && subcategory!==0)\n          createNewTicket(newTicket);\n        else{\n          Notification.addNotification({message:'Error: No categories have been defined yet. No ticket has been inserted',type:'error'});\n        }\n\n    })\n}\n\nconst createNewTicket=(newTicket)=>{\n    let xhr = new XMLHttpRequest();\n    \n    //Se prepara el objeto a enviar\n    const formData= new FormData();\n    formData.append('wstoken',token);\n    formData.append('wsfunction', 'local_ticketmanagement_add_ticket');\n    formData.append('moodlewsrestformat', 'json');\n    formData.append('params[0][subcategoryid]',newTicket.subcategoryid);\n    formData.append('params[0][traineeid]',newTicket.traineeid);\n    formData.append('params[0][state]',newTicket.state);\n    formData.append('params[0][priority]',newTicket.priority);\n    formData.append('params[0][description]',newTicket.description);\n    formData.append('params[0][fileid]',newTicket.fileid);\n    formData.append('params[0][familiarid]',newTicket.familiarid);\n\n    xhr.open('POST',url,true);\n    xhr.send(formData);\n\n    xhr.onload = (ev)=> {\n        reqHandlerNewTicket(xhr);\n    }\n\n    xhr.onerror = ()=> {\n        rejectAnswer(xhr);\n    }\n}\n\nconst reqHandlerNewTicket = (xhr) => {\n  if (xhr.readyState === 4 && xhr.status === 200) {\n      if (xhr.response) {\n          const response = JSON.parse(xhr.response);\n\n          if (response) {\n              window.console.log(response);\n              addToast('Ticket created successfully: ' + response.id);\n\n              // Actualiza el número de tickets y las páginas\n              let numRecords = parseInt(document.querySelector('#num_records').textContent.trim()) + 1;\n              let numPages = Math.ceil(numRecords / 25); // Cálculo de las páginas necesarias\n              let currentPage = numPages;\n\n              // Actualiza la lista de páginas en el paginador\n              const pageList = [];\n              let pagePrevious = Math.max(1, currentPage - 1);\n              let pageNext = currentPage + 1;\n              if (numPages===1){\n                pageNext=1;\n              }\n              \n              \n              for (let i = 1; i <= numPages; i++) {\n                  pageList.push({\n                      page: i,\n                      active: i === currentPage\n                  });\n              }\n\n              const formattedResponse = {\n                  listadoTickets: [{\n                      ticketnumber: response.id,\n                      username: response.username,\n                      familyissue: response.familyissue,\n                      state: response.state,\n                      priority: response.priority,\n                      assigned: 'Waiting to be assigned.',\n                      date: response.dateticket,\n                      description: response.description,\n                      familyissue: response.familyissue\n                  }],\n                  num_records: numRecords,\n                  num_total_records: numRecords,\n                  num_pages: numPages,\n                  pages: pageList,\n                  previous: [{\n                      page: pagePrevious,\n                      url: '#'\n                  }],\n                  next: [{\n                      page: pageNext,\n                      url: '#'\n                  }],\n                  first: [{\n                      page: 1,\n                      url: '#'\n                  }],\n                  last: [{\n                      page: numPages,\n                      url: '#'\n                  }],\n              };\n\n              addTickettoTemplate(formattedResponse);\n          } else {\n              addToast('Something went wrong. No ticket created');\n          }\n      }\n  }\n};\n\n\nfunction addTickettoTemplate(response){\n    //Render the choosen mustache template by Javascript\n    Templates.renderForPromise('local_ticketmanagement/tr_log-ajax',response)\n    .then(({html,js})=>{\n      const content=document.querySelector('#tablebody');\n      const numRecords = document.querySelectorAll('.tickets').length;\n      \n      // Si el número total de registros supera los 25, limpiar la tabla para una nueva página\n      if (numRecords >= 25) {\n        content.innerHTML = '';  // Limpiar solo cuando se supere el límite de 25 registros\n      }\n\n      Templates.appendNodeContents(content,html,js);\n      const newTicket=document.querySelectorAll('.tickets')[document.querySelectorAll('.tickets').length-1];\n      newTicket.addEventListener('click',(e)=>{\n        \n          showTicketFormPopup(e);\n        \n      });\n\n      const logs=document.querySelectorAll('.logs')[document.querySelectorAll('.logs').length-1];\n\n    \n        logs.addEventListener('click',(e)=>{\n          const filaPadre=e.target.closest('tr');\n          \n            showTicketActions(e);\n          \n        })\n   \n\n      const assignbtn=document.querySelectorAll('.assignbtn')[document.querySelectorAll('.assignbtn').length-1];\n      assignbtn.addEventListener('click',(e)=>{\n        const filaPadre=e.target.closest('tr');\n        if (!filaPadre.classList.contains('cerrado')){\n          \n          showAssigmentFormPopup(e);\n        } else {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n        \n      })\n\n\n      \n\n\n\n      \n      //En caso de que se superen 25 tickets por página, se crea una nueva página y añade el registro ahí\n\n\n      Templates.renderForPromise('local_ticketmanagement/pagebar_log-ajax',response)\n      .then(({html,js})=>{\n        const content=document.querySelector('#pagination');\n        content.innerHTML='';\n        Templates.appendNodeContents(content,html,js);\n\n\n        const pages=document.querySelectorAll('.page-link');\n        pages.forEach((page)=>{\n          page.addEventListener('click',(ev)=>{\n            window.console.log('adleante');\n            ev.preventDefault();\n            ev.stopPropagation();\n            const token = document.querySelector('input[name=\"token\"]');\n            const page= document.querySelector('input[name=\"page\"]');\n    \n            //Se obtiene el elemento padre del elemento clicado\n            const padre=ev.currentTarget.parentElement;\n            \n            if (padre.dataset.control==='first' || padre.dataset.control==='last' || padre.dataset.control==='previous' || padre.dataset.control==='next'){\n              //Si es la primera página se coge el valor de arial-label\n              page.value=ev.currentTarget.getAttribute('aria-label');\n            } else {\n              page.value=ev.currentTarget.textContent.trim();\n            }\n            \n            //Obtenemos el ordenamiento y el campo de orden actuales\n            const orderby = document.querySelector('input[name=\"orderby\"]').value;\n            const order = document.querySelector('input[name=\"order\"]').value;\n            const activePage=parseInt(page.value);\n            const startdate= document.querySelector('#startdate');\n            const enddate= document.querySelector('#enddate');\n    \n            const startdateUnixFormat=truncateDateToDay(new Date(startdate.value));\n            const enddateUnixFormat=truncateDateToDay(new Date(enddate.value));\n    \n            requestDataToServer(activePage,startdateUnixFormat, enddateUnixFormat,parseInt(order), orderby, parseInt(page.value), token.value, url);\n          });\n        });\n        \n      }).catch((error)=>displayException(error));\n    }).catch((error)=>displayException(error));\n  }\n\n  const truncateDateToDay=(date) =>{\n    // Create a new Date object with the year, month, and date from the input date.\n    const truncatedDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n  \n    // Convert the truncated date to Unix time (milliseconds since the Unix epoch).\n    const unixTime = truncatedDate.getTime() / 1000; // Divide by 1000 to get seconds\n  \n    return unixTime;\n  }\n\n  const requestDataToServer=(activePage,firstDayOfWeek, lastDayOfWeek, order,orderby,page,token,url)=>{\n    let xhr = new XMLHttpRequest();\n      \n      //Se prepara el objeto a enviar\n      const formData= new FormData();\n      formData.append('wstoken',token);\n      formData.append('wsfunction', 'local_ticketmanagement_get_tickets');\n      formData.append('moodlewsrestformat', 'json');\n      formData.append('params[0][order]',order);\n      formData.append('params[0][orderby]',orderby);\n      formData.append('params[0][page]',page);\n      formData.append('params[0][startdate]',firstDayOfWeek);\n      formData.append('params[0][enddate]',lastDayOfWeek);\n      formData.append('params[0][activePage]',activePage);\n      \n      \n  \n      xhr.open('POST',url,true);\n      xhr.send(formData);\n  \n      xhr.onload = (ev)=> {\n          reqHandlerGetTickets(xhr);\n      }\n  \n      xhr.onerror = ()=> {\n          rejectAnswer(xhr);\n      }\n  }\n\n  const reqHandlerGetTickets=(xhr)=>{\n    if (xhr.readyState=== 4 && xhr. status === 200){\n      if (xhr.response){\n          const response=JSON.parse(xhr.response);\n          loadTemplatefromResponse(response);\n          \n      }\n   }\n  }\n  \n  const loadTemplatefromResponse=(response)=>{\n    //Render the choosen mustache template by Javascript\n    Templates.renderForPromise('local_ticketmanagement/content_log-ajax',response)\n    .then(({html,js})=>{\n    const content=document.querySelector('#content');\n    content.innerHTML='';\n      Templates.appendNodeContents(content,html,js);\n      \n      //Ahora que se ha cargado la plantilla, se puede añadir el evento a los enlaces de ordenación\n      const orderlinks=document.querySelectorAll('.orderby');\n      orderlinks.forEach((link)=>{\n        link.addEventListener('click',(ev)=>{\n          ev.preventDefault();\n  \n          //Se obtienen los valores de los campos necesarios\n          const token = document.querySelector('input[name=\"token\"]').value;\n          const page= document.querySelector('input[name=\"page\"]');\n  \n          //Obtenemos el ordenamiento y el campo de orden actuales\n          const orderby = document.querySelector('input[name=\"orderby\"]');\n          const order = document.querySelector('input[name=\"order\"]');\n  \n          //Si el campo de ordenamiento es el mismo que el actual, se cambia el orden\n          if (ev.target.dataset.activo==='activo'){\n            if (order.value==='1'){\n              ev.target.dataset.order=0;\n              order.value=0;\n            } else {\n              ev.target.dataset.order=1;\n              order.value=1;\n            }\n          } else {\n            orderlinks.forEach((link)=>{\n              link.dataset.activo='';\n            });\n            ev.target.dataset.activo='activo';\n            orderby.value=ev.target.dataset.orderby;\n            ev.target.dataset.order=1;\n            order.value=1;\n          }\n  \n          const activePage=document.querySelector('li.page-item.active>a').textContent.trim();\n  \n          const startdate= document.querySelector('#startdate');\n          const enddate= document.querySelector('#enddate');\n  \n          const startdateUnixFormat=truncateDateToDay(new Date(startdate.value));\n          const enddateUnixFormat=truncateDateToDay(new Date(enddate.value));\n          \n          requestDataToServer(activePage,startdateUnixFormat, enddateUnixFormat, parseInt(order.value),orderby.value,page.value,token,url);\n        });\n      });\n  \n      const pages=document.querySelectorAll('.page-link');\n      pages.forEach((page)=>{\n        page.addEventListener('click',(ev)=>{\n          ev.preventDefault();\n          ev.stopPropagation();\n          const token = document.querySelector('input[name=\"token\"]');\n          const page= document.querySelector('input[name=\"page\"]');\n  \n          //Se obtiene el elemento padre del elemento clicado\n          const padre=ev.currentTarget.parentElement;\n          \n          if (padre.dataset.control==='first' || padre.dataset.control==='last' || padre.dataset.control==='previous' || padre.dataset.control==='next'){\n            //Si es la primera página se coge el valor de arial-label\n            page.value=ev.currentTarget.getAttribute('aria-label');\n          } else {\n            page.value=ev.currentTarget.textContent.trim();\n          }\n          \n          //Obtenemos el ordenamiento y el campo de orden actuales\n          const orderby = document.querySelector('input[name=\"orderby\"]').value;\n          const order = document.querySelector('input[name=\"order\"]').value;\n          const activePage=parseInt(page.value);\n          const startdate= document.querySelector('#startdate');\n          const enddate= document.querySelector('#enddate');\n  \n          const startdateUnixFormat=truncateDateToDay(new Date(startdate.value));\n          const enddateUnixFormat=truncateDateToDay(new Date(enddate.value));\n  \n          requestDataToServer(activePage,startdateUnixFormat, enddateUnixFormat,parseInt(order), orderby, parseInt(page.value), token.value, url);\n        });\n      });\n  \n    })\n    .catch((error)=>displayException(error));\n  }\n\n  const showTicketFormPopup=(e)=>{\n    e.stopPropagation();\n    const ticketId=e.target.textContent.trim();\n    \n    const modalForm=new ModalForm({\n        formClass: \"\\\\local_ticketmanagement\\\\form\\\\TicketFormPopup\",\n        args: {num_ticket: ticketId},\n        modalConfig: {title: `Ticket details: #${ticketId}`},\n        returnFocus:e.target\n    });\n\n    modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e)=>{\n         //Se actualiza la pagina principal con los nuevos valores y se envia email de notificación\n         const formElement=e.target;\n         const subcategoryValue = formElement.querySelector('select[name=\"subcategory\"]')?.value;\n         window.console.log(e.detail);\n         if (subcategoryValue) {\n             e.detail.subcategory = subcategoryValue;\n         }\n \n \n         updateTicket(e.detail,token,url);\n    });\n\n    modalForm.addEventListener(modalForm.events.LOADED, (e)=>{\n        // Obtener el formulario modal después de que se ha cargado\n        const formElement = e.target;\n        window.console.log(\"disabled...\");\n        // Usa la función areElementsLoaded para esperar hasta que los selectores estén cargados en el DOM\n        areElementsLoaded('select[name=\"category\"], select[name=\"subcategory\"]', formElement).then((elements) => {\n\n            // Una vez que los selectores están disponibles, los seleccionamos\n            const categorySelect = formElement.querySelector('select[name=\"category\"]');\n            const subcategorySelect = formElement.querySelector('select[name=\"subcategory\"]');\n    \n            // Asegúrate de que ambos selectores existen\n            if (categorySelect && subcategorySelect) {\n                // Añadir un listener para cuando cambie la categoría seleccionada\n                categorySelect.addEventListener('change', (event) => {\n                    const selectedCategory = event.target.value;\n                    window.console.log(`Categoría seleccionada: ${selectedCategory}`);\n    \n                    // Lógica para actualizar las opciones del selector de subcategorías\n                    updateSubcategory(selectedCategory, subcategorySelect,token);\n                });\n            } else {\n                window.console.error('Los selectores de categoría y subcategoría no están disponibles.');\n            }\n\n            const closebox=formElement.querySelector(\"input[type='checkbox'][name='close']\");\n            const cancelledbox=formElement.querySelector(\"input[type='checkbox'][name='cancelled']\");\n            const bosave=formElement.querySelector(\".btn-primary\");\n            \n            if (closebox.checked){\n              bosave.disabled=true;\n              closebox.disabled=true;\n            }\n\n\n            if (cancelledbox.checked){\n              bosave.disabled=true;\n              cancelledbox.disabled=true;\n            }\n            \n        }).catch((error) => {\n            window.console.error('Error al cargar los elementos select:', error);\n        });\n        \n        }\n    );\n    \n    modalForm.show();\n\n}\n\nconst showAssigmentFormPopup=(e)=>{\n  e.stopPropagation();\n  const fila=e.target.closest('tr');\n  const ticket=fila.querySelector('.tickets');\n  const ticketId=ticket.textContent;\n  const modalForm=new ModalForm({\n      formClass: \"\\\\local_ticketmanagement\\\\form\\\\AssignmentFormPopup\",\n      args: {num_ticket: ticketId},\n      modalConfig: {title: `Ticket details: #${ticketId}`},\n      returnFocus:e.target\n  });\n\n  modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e)=>{\n      //Se actualiza la pagina principal con los nuevos valores y se envia email de notificación\n        \n      const ticket=e.detail.ticket;\n      const td=document.querySelector(`td a.assignbtn[data-ticketid=\"${ticket.id}\"]`).parentElement;\n      const link=document.querySelector(`a.assignbtn[data-ticketid=\"${ticket.id}\"]`)\n      const span = link.nextElementSibling; \n      span.textContent=ticket.user;\n      const state=document.querySelector(`td a.assignbtn[data-ticketid=\"${ticket.id}\"]`).parentElement.parentElement.children[4];\n      state.textContent=ticket.state;\n  });\n\n  modalForm.addEventListener(modalForm.events.LOADED, (e)=>{\n      //Changing the text of the dynamic button\n      //e.target.querySelector(\"button[data-action='save']\").textContent=\"Send Email\"\n      \n      }\n  );\n  \n  modalForm.show();\n\n}\n\nconst showTicketActions=(e)=>{\n  e.stopPropagation();\n  const ticketId=e.target.dataset.ticketid;\n  const modalForm=new ModalForm({\n      formClass: \"\\\\local_ticketmanagement\\\\form\\\\ActionsFormPopup\",\n      args: {num_ticket: ticketId},\n      modalConfig: {title: `Ticket details: #${ticketId}`},\n      returnFocus:e.target\n  });\n\n  modalForm.show();\n\n\n  modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, (e)=>{\n      //Se actualiza la pagina principal con los nuevos valores y se envia email de notificación\n  });\n\n  // Listen for the modal LOADED event\n  modalForm.addEventListener(modalForm.events.LOADED, (e) => {\n      // Get the button after the modal is fully loaded\n      // Get the modal element after it is loaded\n      \n      areElementsLoaded('#boactionid').then((elements)=>{\n          const addActionBtn = (elements.length>0)?elements[0]:null;\n          \n          if (addActionBtn) {\n              // Add an event listener to the button\n              addActionBtn.addEventListener('click', function() {\n                  console.log('Add Action button clicked!');\n              });\n          }\n\n      })\n  });\n}\n\nconst updateTicket = (obj,token,url)=>{\n  let xhr = new XMLHttpRequest();\n    \n    //Se prepara el objeto a enviar\n    const formData= new FormData();\n    formData.append('wstoken',token);\n    formData.append('wsfunction', 'local_ticketmanagement_edit_ticket');\n    formData.append('moodlewsrestformat', 'json');\n    formData.append('params[0][ticketid]',obj.ticketid);\n    formData.append('params[0][fileid]',obj.attachments);\n    formData.append('params[0][cancelled]',obj.cancelled);\n    formData.append('params[0][state]',obj.hiddenstate);\n    formData.append('params[0][priority]',obj.priority);\n    formData.append('params[0][closed]',obj.close);\n    formData.append('params[0][category]',obj.subcategory);\n\n    xhr.open('POST',url,true);\n    xhr.send(formData);\n\n    xhr.onload = (ev)=> {\n        reqHandlerUpdateTicket(xhr);\n    }\n\n    xhr.onerror = ()=> {\n        rejectAnswer(xhr);\n    }\n\n}\n\nconst reqHandlerUpdateTicket=(xhr)=>{\n  if (xhr.readyState=== 4 && xhr. status === 200){\n      if (xhr.response){\n          const response=JSON.parse(xhr.response);\n          \n          if (response){\n            window.console.log(response.ticket);\n            const ticket=response.ticket;\n            updateTemplate(ticket);\n          }\n          \n      }\n    }\n}\n\nconst updateTemplate=(ticket)=>{\n  const fila = document.querySelector(`#${ticket.ticketid}`);\n  const state = fila.querySelector('td:nth-child(5)');\n  const priority = fila.querySelector('td:nth-child(7)');\n  state.textContent=ticket.state;\n  priority.textContent=ticket.priority;\n  window.console.log(fila.querySelector('.assignbtn'));\n    if (ticket.state==='Closed' || ticket.state==='Cancelled'){\n        fila.classList.add(\"cerrado\");\n        const boAssigment=fila.querySelector('.assignbtn');\n        boAssigment.addEventListener(\"click\", (event) => {\n            event.stopPropagation(); // Detener la propagación del evento\n            event.preventDefault();  // Prevenir cualquier acción predeterminada\n        });\n        // Opcional: cambiar el cursor a \"not-allowed\" para indicar que no es clickeable\n        boAssigment.style.cursor = \"not-allowed\";\n    }\n\n}\n\nconst areElementsLoaded = (selector, parentElement = document) => {\n  return new Promise((resolve) => {\n      const checkElements = () => {\n          const elements = parentElement.querySelectorAll(selector);\n          if (elements.length > 0 && Array.from(elements).every(elem => elem !== null)) {\n              resolve(elements);\n          } else {\n              requestAnimationFrame(checkElements);\n          }\n      };\n      checkElements();\n  });\n};"],"names":["url","M","cfg","wwwroot","token","document","querySelector","value","addEventListener","e","preventDefault","stopImmediatePropagation","project","vessel","trainee","category","subcategory","familyissue","description","fileid","familiar","createNewTicket","projectid","vesselid","traineeid","categoryid","subcategoryid","state","priority","familiarid","addNotification","message","type","newTicket","xhr","XMLHttpRequest","formData","FormData","append","open","send","onload","ev","reqHandlerNewTicket","onerror","rejectAnswer","readyState","status","response","JSON","parse","window","console","log","id","numRecords","parseInt","textContent","trim","numPages","Math","ceil","currentPage","pageList","pagePrevious","max","pageNext","i","push","page","active","renderForPromise","then","_ref","html","js","content","querySelectorAll","length","innerHTML","appendNodeContents","showTicketFormPopup","target","closest","showTicketActions","classList","contains","stopPropagation","showAssigmentFormPopup","_ref2","forEach","padre","currentTarget","parentElement","dataset","control","getAttribute","orderby","order","activePage","startdate","enddate","startdateUnixFormat","truncateDateToDay","Date","enddateUnixFormat","requestDataToServer","catch","error","addTickettoTemplate","listadoTickets","ticketnumber","username","assigned","date","dateticket","num_records","num_total_records","num_pages","pages","previous","next","first","last","getFullYear","getMonth","getDate","getTime","firstDayOfWeek","lastDayOfWeek","reqHandlerGetTickets","loadTemplatefromResponse","_ref3","orderlinks","link","activo","ticketId","modalForm","ModalForm","formClass","args","num_ticket","modalConfig","title","returnFocus","events","FORM_SUBMITTED","subcategoryValue","_formElement$querySel","detail","updateTicket","LOADED","formElement","areElementsLoaded","elements","categorySelect","subcategorySelect","event","selectedCategory","updateSubcategory","closebox","cancelledbox","bosave","checked","disabled","show","ticket","nextElementSibling","user","children","ticketid","addActionBtn","obj","attachments","cancelled","hiddenstate","close","reqHandlerUpdateTicket","updateTemplate","fila","add","boAssigment","style","cursor","selector","Promise","resolve","checkElements","Array","from","every","elem","requestAnimationFrame"],"mappings":"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"}