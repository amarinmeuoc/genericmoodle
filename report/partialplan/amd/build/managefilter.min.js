define("report_partialplan/managefilter",["exports","core/notification","core/templates"],(function(_exports,_notification,_templates){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};_exports.init=()=>{const sdlink=document.querySelector("#sd-link"),edlink=document.querySelector("#ed-link");sdlink.addEventListener("click",(e=>{e.preventDefault();const customerid=null!==document.querySelector("#id_selcustomer")?document.querySelector("#id_selcustomer").value:document.querySelector('input[name="selcustomer"').value,order=document.querySelector('input[name="order"]'),orderby=document.querySelector('input[name="orderby"]'),day=document.querySelector("#id_assesstimefinish_day").value,month=document.querySelector("#id_assesstimefinish_month").value,year=document.querySelector("#id_assesstimefinish_year").value,group=document.querySelector("#id_selgroup").value,billid=document.querySelector("#id_tebillid").value,unixtime=new Date(year,month-1,day).getTime()/1e3;orderby.value="startdate",order.value="1"===order.value?"0":"1",requestResultFromServer(customerid,group,billid,unixtime,order.value,orderby.value)})),edlink.addEventListener("click",(e=>{e.preventDefault();const customerid=null!==document.querySelector("#id_selcustomer")?document.querySelector("#id_selcustomer").value:document.querySelector('input[name="selcustomer"').value,order=document.querySelector('input[name="order"]'),orderby=document.querySelector('input[name="orderby"]'),day=document.querySelector("#id_assesstimefinish_day").value,month=document.querySelector("#id_assesstimefinish_month").value,year=document.querySelector("#id_assesstimefinish_year").value,group=document.querySelector("#id_selgroup").value,billid=document.querySelector("#id_tebillid").value,unixtime=new Date(year,month-1,day).getTime()/1e3;orderby.value="enddate",order.value="1"===order.value?"0":"1",requestResultFromServer(customerid,group,billid,unixtime,order.value,orderby.value)}))};const requestResultFromServer=(customerid,group,billid,unixtime,order,orderby)=>{let xhr=new XMLHttpRequest;const url=M.cfg.wwwroot+"/webservice/rest/server.php",token=document.querySelector('input[name="token"]').value;xhr.open("POST",url,!0);const formData=new FormData;formData.append("wstoken",token),formData.append("wsfunction","report_partialplan_get_training_plan"),formData.append("moodlewsrestformat","json"),formData.append("params[0][customerid]",customerid),formData.append("params[0][groupid]",parseInt(group)),formData.append("params[0][billid]",billid),formData.append("params[0][unixtime]",unixtime),formData.append("params[0][order]",order),formData.append("params[0][orderby]",orderby),xhr.send(formData),xhr.onload=event=>{onLoadFunction(xhr,group,token)},xhr.onprogress=event=>{onProgressFunction(event)},xhr.onerror=function(){window.console.log("Solicitud fallida")}},onLoadFunction=(myXhr,selectedGroup,token)=>{if(4===myXhr.readyState&&200===myXhr.status){!function(response){document.querySelector("#content").innerHTML="";const responseData=response[0];_templates.default.renderForPromise("report_partialplan/content_con-ajax",responseData).then((_ref=>{let{html:html,js:js}=_ref;const content=document.querySelector("#content");content.innerHTML="",_templates.default.appendNodeContents(content,html,js)})).catch((error=>(0,_notification.exception)(error)))}(JSON.parse(myXhr.response))}},onProgressFunction=event=>{event.lengthComputable?window.console.log("Recibidos ".concat(event.loaded," de ").concat(event.total," bytes")):window.console.log("Recibidos ".concat(event.loaded," bytes"))}}));

//# sourceMappingURL=managefilter.min.js.map