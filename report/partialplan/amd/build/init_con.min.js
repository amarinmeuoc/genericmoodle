define("report_partialplan/init_con",["exports","core/notification","core/templates"],(function(_exports,_notification,_templates){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};const url=M.cfg.wwwroot+"/webservice/rest/server.php";_exports.init=()=>{areElementsLoaded("#filterformid input, #filterformid select").then((elements=>{const token=document.querySelector('input[name="token"]').value,orderby=document.querySelector('input[name="orderby"]'),order=document.querySelector('input[name="order"]'),day=document.querySelector("#id_assesstimefinish_day").value,month=document.querySelector("#id_assesstimefinish_month").value,year=document.querySelector("#id_assesstimefinish_year").value,customerid=document.querySelector("#id_selcustomer").value,groupid=document.querySelector("#id_selgroup").value,billid=document.querySelector("#id_tebillid").value,unixtime=new Date(year,month-1,day).getTime()/1e3;requestResultFromServer(url,token,orderby.value,order.value,unixtime,customerid,groupid,billid);document.querySelector("#id_bosubmit").addEventListener("click",(()=>{orderby.value="startdate",order.value=1;const groupid=document.querySelector("#id_selgroup").value,billid=document.querySelector("#id_tebillid").value,day=document.querySelector("#id_assesstimefinish_day").value,month=document.querySelector("#id_assesstimefinish_month").value,year=document.querySelector("#id_assesstimefinish_year").value,customerid=document.querySelector("#id_selcustomer").value,unixtime=new Date(year,month-1,day).getTime()/1e3;requestResultFromServer(url,token,orderby.value,order.value,unixtime,customerid,groupid,billid)}))}))};const requestResultFromServer=(url,token,orderby,order,unixtime,customerid,groupid,billid)=>{const data={wstoken:token,wsfunction:"report_partialplan_get_training_plan",moodlewsrestformat:"json","params[0][orderby]":orderby,"params[0][order]":order,"params[0][unixtime]":parseInt(unixtime),"params[0][customerid]":customerid,"params[0][groupid]":groupid,"params[0][billid]":billid};fetch(url,{method:"POST",body:new URLSearchParams(data),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((response=>response.json())).then((response=>{if(response.exception)(0,_notification.exception)(response);else{const responseData=response[0];_templates.default.renderForPromise("report_partialplan/content_con-ajax",responseData).then((_ref=>{let{html:html,js:js}=_ref;const content=document.querySelector("#content");content.innerHTML="",_templates.default.appendNodeContents(content,html,js)}))}})).catch((error=>{(0,_notification.exception)(error),window.console.log("Error:",error)}))},areElementsLoaded=selector=>new Promise((resolve=>{const checkElements=()=>{const elements=document.querySelectorAll(selector);elements.length>0&&Array.from(elements).every((elem=>null!==elem))?resolve(elements):requestAnimationFrame(checkElements)};checkElements()}))}));

//# sourceMappingURL=init_con.min.js.map